HTTP/1.1 200 OK
Server: Lotus-Domino
Date: Thu, 10 Aug 2017 03:00:19 GMT
Connection: close
Last-Modified: Thu, 10 Aug 2017 03:00:17 GMT
Expires: Tue, 01 Jan 1980 06:00:00 GMT
Content-Type: text/html; charset=GB2312
Content-Length: 34701
Content-Language: zh-cn
Cache-control: no-cache

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv='Content-Type' content='text/html; charset='gb2312'> <LINK rel="stylesheet" href="/oastar/css/word.css" type="text/css"><title>只读查看</title><BASE Target="_self">
<script language="JavaScript" type="text/javascript">
<!-- 
/*form表单名称:_DocumentiWebOffice名称:WebOfficeWebObject文档对象接口，相当于：如果是Word  文件，WebObject 是Word  VBA的ActiveDocument对象如果是Excel 文件，WebObject 是Excel VBA的ActiveSheet对象如：_Document.WebOffice.WebObject*/function WebDownLoadFile(){  mbpath=location.protocol + "//"+document.forms(0).Server_Name.value+":"+document.forms(0).Server_Port.value+"/"+"oastar/WordControl/admb.doc"  mResult=document.forms(0).WebOffice.WebDownLoadFile(mbpath,"c:\\doctemp.doc");   //参数一:服务器文件URL地址   参数二:保存为本地的路径  if (mResult){    document.forms(0).WebOffice.WebOpenLocalFile("c:\\doctemp.doc");   //打开本地文档    //alert("打开成功");  }else{    //alert("打开失败");  }}//作用：显示操作状态function StatusMsg(mString){    window.status=mString;    StatusBar.innerText=mString;}//作用：载入iWebOfficefunction Load(){          var mRecordID;     var mFileName;     var mHref=location.href;     //alert(mHref);     var mIndex=mHref.indexOf('EditType');     if (mIndex>0){        document.forms(0).EditType.value=mHref.substring(mIndex+9,mIndex+10);  //取出EditType的值     }else{        document.forms(0).EditType.value="1";  //如没有取到，则EditType='1'     }     mIndex=mHref.indexOf('FileType');     if (mIndex>0){        document.forms(0).FileType.value=mHref.substring(mIndex+9,mIndex+13);  //取出FileType的值     }else{        document.forms(0).FileType.value=".doc";  //如没有取到，则FileType='.doc'     }     mIndex=mHref.indexOf('RecordID');     if (mIndex>0){        mRecordID = mHref.substring(mIndex+9);        mIndex = mRecordID.indexOf("&");        if (mIndex>0){            document.forms(0).RecordID.value=mRecordID.substring(0,mIndex);  //取出RecordID的值         }else{           document.forms(0).RecordID.value=mRecordID;         }     }        mIndex=mHref.indexOf('FileName');     if (mIndex>0){        mFileName = mHref.substring(mIndex+9);        mIndex = mFileName.indexOf("&");        if (mIndex>0){            document.forms(0).FileName.value=mFileName.substring(0,mIndex);  //取出FileName的值         }else{           document.forms(0).FileName.value=mFileName;         }     }  //alert("参数传递完成！")  //对编辑方式下编辑类型转换为方式二    if (document.forms(0).EditType.value=="2"){  document.forms(0).EditType.value="-1,0,1,1,0,0"  }     //不显示痕迹只读型转换为方式二    if (document.forms(0).EditType.value=="4"){  document.forms(0).EditType.value="-1,1,0,0,0,0"  }            //以下属性必须设置，实始化iWebOffice  document.forms(0).WebOffice.WebUrl=document.forms(0).WebUrl.value;       //WebUrl:系统服务器路径，与服务器文件交互操作，如保存、打开文档，重要文件   document.forms(0).WebOffice.RecordID=document.forms(0).RecordID.value;   //RecordID:本文档记录编号  document.forms(0).WebOffice.Template=document.forms(0).Template.value;   //Template:模板编号  document.forms(0).WebOffice.FileName=document.forms(0).FileName.value;  //FileName:文档名称  document.forms(0).WebOffice.FileType=document.forms(0).FileType.value;   //FileType:文档类型  .doc  .xls  .wps  document.forms(0).WebOffice.EditType=document.forms(0).EditType.value;   //EditType:编辑类型  方式一、方式二  <参考技术文档>  document.forms(0).WebOffice.UserName=document.forms(0).UserName.value;   //UserName:操作用户名，痕迹保留需要  document.forms(0).WebOffice.ExtParam=document.forms(0).DBName.value;     //ExtParam:扩展变量，该处用于传递数据库名称  //以下属性可以不要      //生成的word文件保存表单  document.forms(0).WebOffice.WebSetMsgByName("SAVEDOCFORMNAME",document.forms(0).FormName.value);     document.forms(0).WebOffice.ShowMenu="1";  if(document.forms(0).EditType.value!="0" && document.forms(0).EditType.value!="-1,1,0,0,0,0")  {   document.forms(0).WebOffice.AppendMenu("18","保存(&S)");  document.forms(0).WebOffice.AppendMenu("19","保存并关闭(&Q)");  document.forms(0).WebOffice.AppendMenu("20","关闭(&X)");  document.forms(0).WebOffice.AppendMenu("17","-");  document.forms(0).WebOffice.AppendMenu("1","插入本地文件(&I)");  //document.forms(0).WebOffice.AppendMenu("2","打开本地文件(&L)");  document.forms(0).WebOffice.AppendMenu("3","保存本地文件(&S)");  //document.forms(0).WebOffice.AppendMenu("4","保存远程文件(&U)");  //document.forms(0).WebOffice.AppendMenu("5","-");  //document.forms(0).WebOffice.AppendMenu("5","签名印章(&Q)");  //document.forms(0).WebOffice.AppendMenu("6","验证签章(&Y)");  //document.forms(0).WebOffice.AppendMenu("7","-");  //document.forms(0).WebOffice.AppendMenu("8","保存版本(&B)");  document.forms(0).WebOffice.AppendMenu("13","-");  }  //document.forms(0).WebOffice.AppendMenu("9","打开版本(&D)");    document.forms(0).WebOffice.AppendMenu("15","打印文档(&P)");  //document.forms(0).WebOffice.AppendMenu("16","页面设置(&U)");  //document.forms(0).WebOffice.DisableMenu("宏;选项");  //禁止菜单  //alert("菜单设置完成")  document.forms(0).WebOffice.WebOpen();  	 //打开该文档    交互OfficeServer  调出文档OPTION="LOADFILE"    调出模板OPTION="LOADTEMPLATE"     <参考技术文档>  StatusMsg(document.forms(0).WebOffice.Status);   //状态信息    if (document.forms(0).WebOffice.Status=="打开失败!")	{	//WebDownLoadFile();	StatusMsg(document.forms(0).WebOffice.Status);	}  }//作用：退出iWebOfficefunction UnLoad(){  if (!document.forms(0).WebOffice.WebClose()){     StatusMsg(document.forms(0).WebOffice.Status);  }else{     StatusMsg("关闭文档...");  }}//作用：打开文档function LoadDocument(){  StatusMsg("正在打开文档...");  if (!document.forms(0).WebOffice.WebOpen()){  	//打开该文档    交互OfficeServer的OPTION="LOADFILE"     StatusMsg(document.forms(0).WebOffice.Status);  }else{     StatusMsg(document.forms(0).WebOffice.Status);  }}//作用：保存文档function SaveDocument(){  //document.forms(0).WebOffice.WebSetMsgByName("MyDefine1","自定义变量值1");  //设置变量MyDefine1="自定义变量值1"，变量可以设置多个  在WebSave()时，一起提交到OfficeServer中  if (!document.forms(0).WebOffice.WebSave()){    //交互OfficeServer的OPTION="SAVEFILE"     StatusMsg(document.forms(0).WebOffice.Status);     return false;  }else{     StatusMsg(document.forms(0).WebOffice.Status);     return true;  }}//作用：显示或隐藏痕迹  true表示隐藏痕迹  false表示显示痕迹function ShowRevision(mValue){  if (mValue){     document.forms(0).WebOffice.WebShow(true);     StatusMsg("显示痕迹...");  }else{     document.forms(0).WebOffice.WebShow(false);     StatusMsg("隐藏痕迹...");  }}//作用：获取痕迹function WebGetRevisions(){  var i;  var Text="";  for (i = 1;i <= document.forms(0).WebOffice.WebObject.Revisions.Count;i++){    Text=Text + document.forms(0).WebOffice.WebObject.Revisions.Item(i).Author;    if (document.forms(0).WebOffice.WebObject.Revisions.Item(i).Type=="1"){     Text=Text + '插入:'+document.forms(0).WebOffice.WebObject.Revisions.Item(i).Range.Text+"\r\n";    }else{    Text=Text + '删除:'+document.forms(0).WebOffice.WebObject.Revisions.Item(i).Range.Text+"\r\n";    }  }  alert("痕迹内容：\r\n"+Text);}//作用：刷新文档function WebReFresh(){  document.forms(0).WebOffice.WebReFresh();  StatusMsg("文档已刷新...");}//作用：打开版本function WebOpenVersion(){  document.forms(0).WebOffice.WebOpenVersion();  	//交互OfficeServer  列出版本OPTION="LISTVERSION"     调出版本OPTION="LOADVERSION"   <参考技术文档>  StatusMsg(document.forms(0).WebOffice.Status);}//作用：保存版本function WebSaveVersion(){  document.forms(0).WebOffice.WebSaveVersion();  	//交互OfficeServer的OPTION="SAVEVERSION"    StatusMsg(document.forms(0).WebOffice.Status);}//作用：保存当前版本function WebSaveVersionByFileID(){  var mText=window.prompt("请输入版本说明:","版本号:V");  if (mText==null){     mText="已修改版本.";  }  document.forms(0).WebOffice.WebSaveVersionByFileID(mText);  	//交互OfficeServer的OPTION="SAVEVERSION"  同时带FileID值   <参考技术文档>  StatusMsg(document.forms(0).WebOffice.Status);}//作用：填充模板function LoadBookmarks(){  StatusMsg("正在填充模扳...");  if (!document.forms(0).WebOffice.WebLoadBookmarks()){  	//交互OfficeServer的OPTION="LOADBOOKMARKS"     StatusMsg(document.forms(0).WebOffice.Status);  }else{     StatusMsg(document.forms(0).WebOffice.Status);  }}//作用：标签管理function WebOpenBookMarks(){    document.forms(0).WebOffice.WebOpenBookmarks();  	//交互OfficeServer的OPTION="LISTBOOKMARKS"    StatusMsg(document.forms(0).WebOffice.Status);}//作用：设置书签值  vbmName:标签名称，vbmValue:标签值   标签名称注意大小写function SetBookmarks(vbmName,vbmValue){  if (!document.forms(0).WebOffice.WebSetBookmarks(vbmName,vbmValue)){     StatusMsg(document.forms(0).WebOffice.Status);  }else{     StatusMsg(document.forms(0).WebOffice.Status);  }}//作用：根据标签名称获取标签值  vbmName:标签名称function GetBookmarks(vbmName){  var vbmValue;  vbmValue=document.forms(0).WebOffice.WebGetBookmarks(vbmName);  return vbmValue;}//作用：打印文档function WebOpenPrint(){    document.forms(0).WebOffice.WebOpenPrint();    StatusMsg(document.forms(0).WebOffice.Status);}//作用：页面设置function WebOpenPageSetup(){	if (document.forms(0).WebOffice.FileType==".doc"){	document.forms(0).WebOffice.WebObject.Application.Dialogs(178).Show();	}	if(document.forms(0).WebOffice.FileType==".xls"){	document.forms(0).WebOffice.WebObject.Application.Dialogs(7).Show();	}}//作用：插入图片function WebOpenPicture(){    document.forms(0).WebOffice.WebOpenPicture();    StatusMsg(document.forms(0).WebOffice.Status);}//作用：签名印章function WebOpenSignature(){  alert("如果你要签章,建议采用iSignature电子签章软件进行签章:\r\n下载地址http://www.goldgrid.com/iSignature/Download.asp\r\n该软件是支持CA证书和数字签名技术的,\r\n是通过了国家公安部认证的电子签章产品!");    document.forms(0).WebOffice.WebOpenSignature();  	//交互OfficeServer的 A签章列表OPTION="LOADMARKLIST"    B签章调出OPTION="LOADMARKIMAGE"    C确定签章OPTION="SAVESIGNATURE"    <参考技术文档>    StatusMsg(document.forms(0).WebOffice.Status);}//作用：验证印章Afunction WebShowSignature(){    document.forms(0).WebOffice.WebShowSignature();  	//交互OfficeServer的OPTION="LOADSIGNATURE"    StatusMsg(document.forms(0).WebOffice.Status);}//作用：验证印章Bfunction WebCheckSignature(){    var i=document.forms(0).WebOffice.WebCheckSignature();  	//交互OfficeServer的OPTION="LOADSIGNATURE"    alert("检测结果："+i+"\r\n 注释: (=-1 有非法印章) (=0 没有任何印章) (>=1 有多个合法印章)");    StatusMsg(i);}//作用：存为本地文件function WebSaveLocal(){	var wjbt = document.all.wjbt.value;	var fn = document.forms(0).WebOffice.FileName;		document.forms(0).WebOffice.FileName = wjbt;	document.forms(0).WebOffice.WebSaveLocal();	document.forms(0).WebOffice.FileName = fn;    	StatusMsg(document.forms(0).WebOffice.Status);}//作用：打开本地文件function WebOpenLocal(){    document.forms(0).WebOffice.WebOpenLocal();    StatusMsg(document.forms(0).WebOffice.Status);}//作用：保存为HTML文档function WebSaveAsHtml(){    if (document.forms(0).WebOffice.WebSaveAsHtml())  	//交互OfficeServer的OPTION="SAVEASHTML"    {      document.forms(0).HTMLPath.value="/HTML/"+document.forms(0).RecordID.value+".htm";      window.open( document.forms(0).HTMLPath.value);    }    StatusMsg(document.forms(0).WebOffice.Status);}//作用：保存为文档图片function WebSaveAsPage(){    if (document.forms(0).WebOffice.WebSaveImage())  	//交互OfficeServer的OPTION="SAVEIMAGE"    {      document.forms(0).HTMLPath.value="/HTMLIMAGE/"+document.forms(0).RecordID.value+".htm";      window.open( document.forms(0).HTMLPath.value);    }    StatusMsg(document.forms(0).WebOffice.Status);}//作用：关闭或显示工具 参数1表示工具条名称  参数2为false时，表示关闭  （名称均可查找VBA帮助）//参数2为true时，表示显示function WebToolsVisible(ToolName,Visible){    document.forms(0).WebOffice.WebToolsVisible(ToolName,Visible);    StatusMsg(document.forms(0).WebOffice.Status);}//作用：禁止或启用工具 参数1表示工具条名称  参数2表示工具条铵钮的编号  （名称和编号均可查找VBA帮助）//参数3为false时，表示禁止  参数3为true时，表示启用function WebToolsEnable(ToolName,ToolIndex,Enable){    document.forms(0).WebOffice.WebToolsEnable(ToolName,ToolIndex,Enable);    StatusMsg(document.forms(0).WebOffice.Status);}//作用：保护与解除  参数1为true表示保护文档  false表示解除保护function WebProtect(value){    document.forms(0).WebOffice.WebSetProtect(value,"");  //""表示密码为空}//作用：允许与禁止拷贝功能  参数1为true表示允许拷贝  false表示禁止拷贝function WebEnableCopy(value){    document.forms(0).WebOffice.CopyType=value;}//作用：插入远程服务器图片function WebInsertImage(){    document.forms(0).WebOffice.WebInsertImage('Image','GoldgridLogo.jpg',true,4);   //交互OfficeServer的OPTION="INSERTIMAGE"  参数1表示标签名称  参数2表示图片文件名  参数3为true透明  false表示不透明  参数4为4表示浮于文字上方  5表示衬于文字下方     StatusMsg(document.forms(0).WebOffice.Status);}//作用：下载服务器文件到本地function WebGetFile(){  if (document.forms(0).WebOffice.WebGetFile("c:\\WebGetFile.doc","DownLoad.doc")){   //交互OfficeServer的OPTION="GETFILE"  参数1表示本地路径  参数2表示服务器文件名称    StatusMsg(document.forms(0).WebOffice.Status);  }else{    StatusMsg(document.forms(0).WebOffice.Status);  }  alert(document.forms(0).WebOffice.Status+"\r\n"+"文件放在c:\\WebGetFile.doc");}//作用：上传本地文件到服务器function WebPutFile(){  var mLocalFile=document.forms(0).WebOffice.WebOpenLocalDialog();  if (mLocalFile!=""){    alert(mLocalFile);    if (document.forms(0).WebOffice.WebPutFile(mLocalFile,"Test.doc")){   //交互OfficeServer的OPTION="PUTFILE"  参数1表示本地路径，可以任何格式文件  参数2表示服务器文件名称      StatusMsg(document.forms(0).WebOffice.Status);    }else{      StatusMsg(document.forms(0).WebOffice.Status);    }    alert(document.forms(0).WebOffice.Status);  }}//作用：打开远程文件//function WebDownLoadFile(){//  mResult=document.forms(0).WebOffice.WebDownLoadFile("http://www.goldgrid.com/Images/abc.doc","c:\\abc.doc");//  if (mResult){//    document.forms(0).WebOffice.WebOpenLocalFile("c:\\abc.doc");//    alert("成功");//  }else{//    alert("失败");//  }//}//作用：表格生成及填充function WebSetWordTable(){  var mText="",mName="",iColumns,iCells,iTable;  //设置COMMAND为WORDTABLE  document.forms(0).WebOffice.WebSetMsgByName("COMMAND","WORDTABLE");   //设置变量COMMAND="WORDTABLE"，在WebSendMessage()时，一起提交到OfficeServer中  //发送到服务器上  //如果没有错误  if (document.forms(0).WebOffice.WebSendMessage()){                //交互OfficeServer的OPTION="SENDMESSAGE"	iColumns = document.forms(0).WebOffice.WebGetMsgByName("COLUMNS");  //取得列		iCells = document.forms(0).WebOffice.WebGetMsgByName("CELLS");      //取得行	iTable=document.forms(0).WebOffice.WebObject.Tables.Add(document.forms(0).WebOffice.WebObject.Application.Selection.Range,iCells,iColumns);   //生成表格	for (var i=1; i<=iColumns; i++)	{	    	  for (var j=1; j<=iCells; j++)	  {	     mName=i.toString()+j.toString();		mText=document.forms(0).WebOffice.WebGetMsgByName(mName);	 //取得OfficeServer中的表格内容		iTable.Columns(i).Cells(j).Range.Text=mText;   	//填充单元值	   }	}   }   StatusMsg(document.forms(0).WebOffice.Status);}//作用：获取文档Txt正文function WebGetWordContent(){    alert(document.forms(0).WebOffice.WebObject.Content.Text);}//作用：写Word内容function WebSetWordContent(){  var mText=window.prompt("请输入内容:","测试内容");  if (mText==null){     return (false);  }  else  {     //下面为显示选中的文本     //alert(document.forms(0).WebOffice.WebObject.Application.Selection.Range.Text);     //下面为在当前光标出插入文本     document.forms(0).WebOffice.WebObject.Application.Selection.Range.Text= mText+"\n";     //下面为在第一段后插入文本     //document.forms(0).WebOffice.WebObject.Application.ActiveDocument.Range(1).Text=(mText);  }}//作用：打印黑白文档function WebWordPrintBlackAndWhile(){   var i,n;   //图片变黑白   i=0;   n=document.forms(0).WebOffice.WebObject.Shapes.Count;   for (var i=1; i<=n; i++)   {      document.forms(0).WebOffice.WebObject.Shapes.Item(i).PictureFormat.ColorType=3;   }   i=0;   n=document.forms(0).WebOffice.WebObject.InlineShapes.Count;   for (var i=1; i<=n; i++)   {      document.forms(0).WebOffice.WebObject.InlineShapes.Item(i).PictureFormat.ColorType=3;   }      //文字变黑白   document.forms(0).WebOffice.WebObject.Application.Selection.WholeStory();   document.forms(0).WebOffice.WebObject.Application.Selection.Range.Font.Color = 0;}//作用：用Excel求和function WebGetExcelContent(){    document.forms(0).WebOffice.WebObject.Application.Sheets(1).Select;    document.forms(0).WebOffice.WebObject.Application.Range("C5").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "126";    document.forms(0).WebOffice.WebObject.Application.Range("C6").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "446";    document.forms(0).WebOffice.WebObject.Application.Range("C7").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "556";    document.forms(0).WebOffice.WebObject.Application.Range("C5:C8").Select;    document.forms(0).WebOffice.WebObject.Application.Range("C8").Activate;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "=SUM(R[-3]C:R[-1]C)";    document.forms(0).WebOffice.WebObject.Application.Range("D8").Select;    alert(document.forms(0).WebOffice.WebObject.Application.Range("C8").Text);}//作用：保护工作表单元function WebSheetsLock(){    document.forms(0).WebOffice.WebObject.Application.Sheets(1).Select;    document.forms(0).WebOffice.WebObject.Application.Range("A1").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "产品";    document.forms(0).WebOffice.WebObject.Application.Range("B1").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "价格";    document.forms(0).WebOffice.WebObject.Application.Range("C1").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "详细说明";    document.forms(0).WebOffice.WebObject.Application.Range("D1").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "库存";    document.forms(0).WebOffice.WebObject.Application.Range("A2").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "书签";    document.forms(0).WebOffice.WebObject.Application.Range("A3").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "毛笔";    document.forms(0).WebOffice.WebObject.Application.Range("A4").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "钢笔";    document.forms(0).WebOffice.WebObject.Application.Range("A5").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "尺子";    document.forms(0).WebOffice.WebObject.Application.Range("B2").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "0.5";    document.forms(0).WebOffice.WebObject.Application.Range("C2").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "樱花";    document.forms(0).WebOffice.WebObject.Application.Range("D2").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "300";    document.forms(0).WebOffice.WebObject.Application.Range("B3").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "2";    document.forms(0).WebOffice.WebObject.Application.Range("C3").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "狼毫";    document.forms(0).WebOffice.WebObject.Application.Range("D3").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "50";    document.forms(0).WebOffice.WebObject.Application.Range("B4").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "3";    document.forms(0).WebOffice.WebObject.Application.Range("C4").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "蓝色";    document.forms(0).WebOffice.WebObject.Application.Range("D4").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "90";    document.forms(0).WebOffice.WebObject.Application.Range("B5").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "1";    document.forms(0).WebOffice.WebObject.Application.Range("C5").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "20cm";    document.forms(0).WebOffice.WebObject.Application.Range("D5").Select;    document.forms(0).WebOffice.WebObject.Application.ActiveCell.FormulaR1C1 = "40";    //保护工作表    document.forms(0).WebOffice.WebObject.Application.Range("B2:D5").Select;    document.forms(0).WebOffice.WebObject.Application.Selection.Locked = false;    document.forms(0).WebOffice.WebObject.Application.Selection.FormulaHidden = false;    document.forms(0).WebOffice.WebObject.Application.ActiveSheet.Protect(true,true,true);       alert("已经保护工作表，只有B2-D5单元格可以修改。");}//作用：VBA套红function WebInsertVBA(){		//画线	var object=document.forms(0).WebOffice.WebObject;	var myl=object.Shapes.AddLine(100,60,305,60)	myl.Line.ForeColor=255;	myl.Line.Weight=2;	var myl1=object.Shapes.AddLine(326,60,520,60)	myl1.Line.ForeColor=255;	myl1.Line.Weight=2;	//object.Shapes.AddLine(200,200,450,200).Line.ForeColor=6;   	var myRange=document.forms(0).WebOffice.WebObject.Range(0,0);	myRange.Select();	var mtext="★";	document.forms(0).WebOffice.WebObject.Application.Selection.Range.InsertAfter (mtext+"\n");   	var myRange=document.forms(0).WebOffice.WebObject.Paragraphs(1).Range;   	myRange.ParagraphFormat.LineSpacingRule =1.5;   	myRange.font.ColorIndex=6;   	myRange.ParagraphFormat.Alignment=1;   	myRange=document.forms(0).WebOffice.WebObject.Range(0,0);	myRange.Select();	mtext="金格发[２００３]１５４号";	document.forms(0).WebOffice.WebObject.Application.Selection.Range.InsertAfter (mtext+"\n");	myRange=document.forms(0).WebOffice.WebObject.Paragraphs(1).Range;	myRange.ParagraphFormat.LineSpacingRule =1.5;	myRange.ParagraphFormat.Alignment=1;	myRange.font.ColorIndex=1;		mtext="金格电子政务文件";	document.forms(0).WebOffice.WebObject.Application.Selection.Range.InsertAfter (mtext+"\n");	myRange=document.forms(0).WebOffice.WebObject.Paragraphs(1).Range;	myRange.ParagraphFormat.LineSpacingRule =1.5;		//myRange.Select();	myRange.Font.ColorIndex=6;	myRange.Font.Name="仿宋_GB2312";	myRange.font.Bold=true;	myRange.Font.Size=50;	myRange.ParagraphFormat.Alignment=1;		//myRange=myRange=document.forms(0).WebOffice.WebObject.Paragraphs(1).Range;	document.forms(0).WebOffice.WebObject.PageSetup.LeftMargin=70;	document.forms(0).WebOffice.WebObject.PageSetup.RightMargin=70;	document.forms(0).WebOffice.WebObject.PageSetup.TopMargin=70;	document.forms(0).WebOffice.WebObject.PageSetup.BottomMargin=70;}//作用：套用模版定稿function WebInsertFile(){  var mDialogUrl = "/TemplateForm.html";  var mObject = new Object();      mObject.Template = "";      window.showModalDialog(mDialogUrl, mObject, "dialogHeight:200px; dialogWidth:360px;center:yes;scroll:no;status:no;");   //判断用户是否选择模板  if (mObject.Template==""){    StatusMsg("取消套用模");    return false;  }else{    SaveDocument();    //保存当前编辑的文档    document.forms(0).WebOffice.WebSetMsgByName("COMMAND","INSERTFILE");   //设置变量COMMAND="INSERTFILE"，在WebLoadTemplate()时，一起提交到OfficeServer中     <参考技术文档>       document.forms(0).WebOffice.Template=mObject.Template;                 //全局变量Template赋值，此示例读取服务器目录中模板，如读取数据库中模板，Template值为数据库中的模板编号，则上句代码不需要，如Template="1050560363767"，模板名称为“Word公文模板”，注：模板中有要标签Content，区分大小写，可以自行修改    if (document.forms(0).WebOffice.WebLoadTemplate()){                    //交互OfficeServer的OPTION="LOADTEMPLATE"       //SetBookmarks("Title","关于中间件研发工作会议通知");     //填充模板其它基本信息，如标题，主题词，文号，主送机关等       if (document.forms(0).WebOffice.WebInsertFile()){                   //填充公文正文   交互OfficeServer的OPTION="INSERTFILE"           StatusMsg(document.forms(0).WebOffice.Status);       }else{         StatusMsg(document.forms(0).WebOffice.Status);       }    }else{       StatusMsg(document.forms(0).WebOffice.Status);    }  }}//作用：保存定稿文件function WebUpdateFile(){  if (document.forms(0).WebOffice.WebUpdateFile()){                //交互OfficeServer的OPTION="UPDATEFILE"，类似WebSave()或WebSaveVersion()方法     StatusMsg(document.forms(0).WebOffice.Status);  }else{     StatusMsg(document.forms(0).WebOffice.Status);  }}//作用：导入Textfunction WebInportText(){    var mText;    document.forms(0).WebOffice.WebSetMsgByName("COMMAND","INPORTTEXT");  //设置变量COMMAND="INPORTTEXT"，在WebSendMessage()时，一起提交到OfficeServer中    if (document.forms(0).WebOffice.WebSendMessage()){                    //交互OfficeServer的OPTION="SENDMESSAGE"      mText=document.forms(0).WebOffice.WebGetMsgByName("CONTENT");       //取得OfficeServer传递的变量CONTENT值      document.forms(0).WebOffice.WebObject.Application.Selection.Range.Text=mText;      alert("导入文本成功");    }    StatusMsg(document.forms(0).WebOffice.Status);}//作用：导出Textfunction WebExportText(){    var mText=document.forms(0).WebOffice.WebObject.Content.Text;    document.forms(0).WebOffice.WebSetMsgByName("COMMAND","EXPORTTEXT");  //设置变量COMMAND="EXPORTTEXT"，在WebSendMessage()时，一起提交到OfficeServer中    document.forms(0).WebOffice.WebSetMsgByName("CONTENT",mText);         //设置变量CONTENT="mText"，在WebSendMessage()时，一起提交到OfficeServer中，可用于实现全文检索功能，对WORD的TEXT内容进行检索    if (document.forms(0).WebOffice.WebSendMessage()){                    //交互OfficeServer的OPTION="SENDMESSAGE"      alert("导出文本成功");    }    StatusMsg(document.forms(0).WebOffice.Status);}//作用：获取文档页数function WebDocumentPageCount(){    if (document.forms(0).WebOffice.FileType==".doc"){	var intPageTotal;	intPageTotal = document.forms(0).WebOffice.WebObject.Application.ActiveDocument.BuiltInDocumentProperties(14);	alert("文档页总数："+intPageTotal);    }    if (document.forms(0).WebOffice.FileType==".wps"){	var intPageTotal;	intPageTotal = document.forms(0).WebOffice.WebObject.PagesCount();	alert("文档页总数："+intPageTotal);    }}//作用：签章锁定文件功能function WebSignatureAtReadonly(){  document.forms(0).WebOffice.WebSetProtect(false,"");                  //解除文档保护  document.forms(0).WebOffice.WebSetRevision(false,false,false,false);  //设置文档痕迹保留的状态  参数1:不显示痕迹  参数2:不保留痕迹  参数3:不打印时有痕迹  参数4:不显痕迹处理工具      document.forms(0).WebOffice.WebOpenSignature();                     //交互OfficeServer的 A签章列表OPTION="LOADMARKLIST"    B签章调出OPTION="LOADMARKIMAGE"    C确定签章OPTION="SAVESIGNATURE"    <参考技术文档>    文档中要定义标签Manager，可以自行修改标签名称    StatusMsg(document.forms(0).WebOffice.Status);  document.forms(0).WebOffice.WebSetProtect(true,"");                   //锁定文档}//作用：选择模板function SelectTemplate(TemplateValue){   	document.forms(0).Template.value=TemplateValue;   	Load();}//作用：载入模板function WebTemplateList(){    var mText;    document.forms(0).WebOffice.WebSetMsgByName("COMMAND","TEMPLATELIST");    if (document.forms(0).WebOffice.WebSendMessage()){      mText=document.forms(0).WebOffice.WebGetMsgByName("CONTENT");      idListTemplate.innerHTML = mText;    }    StatusMsg(document.forms(0).WebOffice.Status);}//保存文件function SaveFile(){ if (SaveDocument()){ //document.forms[0].submit(); }else{   StatusMsg(document.forms(0).WebOffice.Status);   return false; }}
// -->
</script>

<script language="JavaScript" type="text/javascript">
<!-- 
document._domino_target = "_self";
function _doClick(v, o, t, h) {
  var form = document._DocumentEdit;
  if (form.onsubmit) {
     var retVal = form.onsubmit();
     if (typeof retVal == "boolean" && retVal == false)
       return false;
  }
  var target = document._domino_target;
  if (o.href != null) {
    if (o.target != null)
       target = o.target;
  } else {
    if (t != null)
      target = t;
  }
  form.target = target;
  form.__Click.value = v;
  if (h != null)
    form.action += h;
  form.submit();
  return false;
}
// -->
</script>
</head>
<body text="#000000" bgcolor="#FFFFFF" topmargin=0 leftmargin=0 onload="try {   　 Load();   		obj=document.all(&quot;NewDoc&quot;)	//if(obj.value==&quot;1&quot;)	//WebTemplateList()　　} catch(error) {		window.returnValue=&quot;err&quot;;		window.close();		return false}　" onunload="try{    //opener.document.all.RecordID.value=document.all.RecordID.value;    //opener.document.all.save.onclick();    UnLoad();} catch(error) {}">

<form method="post" action="/oasys/WorkFlow/dwfw.nsf/DocumentEdit?OpenForm&amp;Seq=1&amp;FileName=39D63AAAB9DF2FAD482581540041FC5A.doc&amp;EditType=4&amp;RecordID=39D63AAAB9DF2FAD482581540041FC5A&amp;FileType=.doc&amp;wjbt=%E5%85%B3%E4%BA%8E%E5%8D%B0%E5%8F%912017%E5%B9%B4%E4%B8%AD%E5%B1%82%E5%B9%B2%E9%83%A8%E6%8D%A2%E5%B1%8A%E5%B7%A5%E4%BD%9C%E5%AE%9E%E6%96%BD%E6%96%B9%E6%A1%88%E7%9A%84%E9%80%9A%E7%9F%A5" name="_DocumentEdit">
<input type="hidden" name="__Click" value="0"><script language="javascript" for=WebOffice event="OnMenuClick(vIndex,vCaption)">
   if (vIndex==1){ //插入本地文件 
      document.forms(0).WebOffice.WebObject.Application.Dialogs(164).Show();
       StatusMsg(document.forms(0).WebOffice.Status);
    } 
   if (vIndex==2){ //打开本地文件 
      WebOpenLocal(); 
       StatusMsg(document.forms(0).WebOffice.Status);
    } 
   if (vIndex==3){ //保存本地文件
      WebSaveLocal(); 
       StatusMsg(document.forms(0).WebOffice.Status);
    } 
   if (vIndex==4){ //保存到服务器上 
      WebSave(); 
       StatusMsg(document.forms(0).WebOffice.Status);
    } 
   if (vIndex==5){ //签名印章 
      WebOpenSignature(); 
    } 
   if (vIndex==6){ //验证签章 
      WebShowSignature(); 
    } 
   if (vIndex==8){ //保存版本 
      WebSaveVersion(); 
       StatusMsg(document.forms(0).WebOffice.Status);
    } 
   if (vIndex==9){ //打开版本 
      WebOpenVersion(); 
       StatusMsg(document.forms(0).WebOffice.Status);
    } 
   if (vIndex==11){ //测试菜单一 
      alert('菜单编号:'+vIndex+'\n\r'+'菜单条目:'+vCaption+'\n\r'+'请根据这些信息编写菜单具体功能'); 
    } 
   if (vIndex==12){ //测试菜单二 
      alert('菜单编号:'+vIndex+'\n\r'+'菜单条目:'+vCaption+'\n\r'+'请根据这些信息编写菜单具体功能'); 
    } 
   if (vIndex==15){ //打印文档 
      WebOpenPrint(); 
    } 
   if (vIndex==16){ //页面设置 
      WebOpenPageSetup(); 
    } 
   if (vIndex==18){ //保存 
      WebSave(); 
       StatusMsg(document.forms(0).WebOffice.Status);
    } 
   if (vIndex==19){ //保存并退出 
      WebSave(); 
      StatusMsg(document.forms(0).WebOffice.Status);
  window.close()
    } 
   if (vIndex==20){ //退出 
window.close()
    } 
  </script><table cellSpacing=1 cellPadding=0 border=0 width=100% height="100%">
<tr><td><OBJECT id="WebOffice" width="100%" height="100%" classid="clsid:23739A7E-5741-4D1C-88D5-D50B18F7C347" codebase="http://oa.yctu.edu.cn:80/oastar/WordControl/iWebOffice2003.ocx#version=5,7,0,0"></OBJECT></td></tr>
<tr height="20"><td align=center><font face="宋体">  </font>
<input type="button" onclick="window.close()" value="关 闭" class="button"><font face="宋体"> </font>
<input type="button" onclick="WebSaveLocal()" value="另存为" class="button"><font face="宋体">  </font></td></tr>
<tr height="20"><td  class="z1" align=center><div id=StatusBar style='display:none'>状态栏</div></td></tr>
</table>
<br>

<input type="button" onclick="document.forms[0].submit();window.returnValue='ok';window.close()" value="SaveInfo" name="SaveInfo" style="width:0px;height:0px"><br>
<br>
<br>
<br>
&lt;META http-equiv='Content-Type' content='text/html; charset='gb2312'&gt; &lt;LINK rel=&quot;stylesheet&quot; href=&quot;/oastar/css/word.css&quot; type=&quot;text/css&quot;&gt;<font color="#ff0000" face="宋体">&lt;script&gt;window.returnValue='ok';window.close();&lt;/script&gt;</font><font color="#ff0000"></font>
<input name="$v2attachmentoptions" type="hidden" value="1">
<input name="Server_Port" type="hidden" value="80">
<input name="Query_String" type="hidden" value="openform&amp;EditType=4&amp;RecordID=39D63AAAB9DF2FAD482581540041FC5A&amp;FileType=.doc&amp;FileName=39D63AAAB9DF2FAD482581540041FC5A.doc&amp;wjbt=%E5%85%B3%E4%BA%8E%E5%8D%B0%E5%8F%912017%E5%B9%B4%E4%B8%AD%E5%B1%82%E5%B9%B2%E9%83%A8%E6%8D%A2%E5%B1%8A%E5%B7%A5%E4%BD%9C%E5%AE%9E%E6%96%BD%E6%96%B9%E6%A1%88%E7%9A%84%E9%80%9A%E7%9F%A5">
<input name="Server_Name" type="hidden" value="oa.yctu.edu.cn">
<input name="WebUrl" type="hidden" value="http://oa.yctu.edu.cn/Servlet/iDmoServer2000">
<input name="RecordID" type="hidden" value="B2E2742A52FA5CA8482581780010819C">
<input name="Template" type="hidden" value="">
<input name="HTMLPath" type="hidden" value="">
<input name="EditType" type="hidden" value="4">
<input name="FileType" type="hidden" value=".doc">
<input name="DBName" type="hidden" value="oasys/WorkFlow/dwfw.nsf">
<input name="sltTemplate" type="hidden" value="">
<input name="FileName" type="hidden" value="B2E2742A52FA5CA8482581780010819C.doc">
<input name="UserName" type="hidden" value="房新侠">
<input name="NewDoc" type="hidden" value="1">
<input name="FormName" type="hidden" value="Document_FileSave">
<input name="wjbt" type="hidden" value="关于印发2017年中层干部换届工作实施方案的通知">
<input name="obj" type="hidden" value="[&lt;OBJECT id=&quot;WebOffice&quot; width=&quot;100%&quot; height=&quot;100%&quot; classid=&quot;clsid:23739A7E-5741-4D1C-88D5-D50B18F7C347&quot; codebase=&quot;http://oa.yctu.edu.cn:80/oastar/WordControl/iWebOffice2003.ocx#version=5,7,0,0&quot;&gt;&lt;/OBJECT&gt;]">
<input name="FlowDocID" type="hidden" value=""></form>
</body>
</html>
